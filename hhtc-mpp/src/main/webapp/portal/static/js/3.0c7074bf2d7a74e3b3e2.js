webpackJsonp([3],{104:function(t,e){t.exports={devtool:"cheap-module-source-map",data:function(){return{userPosition:-1,communityList:[],parkList:[],parkChooseIndex:0,chooseCurrCommunity:"********",chooseCurrCommunityId:"",chooseCurrTime:"----/--/--",max_height:0,btnStr:"再看看别的",resultFlag:!1,isBindCommunity:!1}},mounted:function(){this.max_height=parseFloat($("html").css("height"))-4.5*dpi+"px"},activated:function(){this.getInfo(),this.srcollInit()},created:function(){},watch:{resultFlag:function(){this.resultFlag?btnStr="继续逛逛":btnStr="再看看别的"}},methods:{getInfo:function(){var t=this,e=(new Date).toLocaleDateString();t.chooseCurrTime=e.replace(/\//g,"-"),$.ajax({url:urlDir+"/wx/fans/get",type:"GET",success:function(e){if(0==e.code)if(null!=e.data&&"{}"!=e.data){switch(t.fansInfo=e.data,localStorage.setItem("fansInfo",toJson(e.data)),t.checkUserPosition(e.data.infor_state),t.userPosition){case-1:break;case 0:t.goRouter("/accredit")}t.isBindCommunity?(t.loadPark(e.data.communityId),t.chooseCurrCommunity=e.data.communityName,t.chooseCurrCommunityId=e.data.communityId):t.initCommunityList()}else error_msg("数据异常",2e3);else error_msg(e.code+" 错误 "+e.msg,2e3)},error:function(t){error_msg("网络错误",2e3)}})},checkUserPosition:function(t){var e=this;if(t+="",5!=t.length)return-1;var i=(t.charAt(0),t.charAt(1),t.charAt(2)),o=(t.charAt(3),t.charAt(4),t.indexOf("0"));e.userPosition=o,e.isBindCommunity=1==i},initCommunityList:function(){var t=this,e=(new Date).toLocaleDateString();t.chooseCurrTime=e.replace(/\//g,"-"),$.ajax({url:urlDir+"/wx/community/listByCityName?cityName=重庆市",type:"GET",success:function(e){0==e.code?(t.communityList=[],e.data.forEach(function(e,i){t.communityList.push({id:e.id,name:e.name})}),t.communityList.length<1?error_msg("当前没有小区提供选择",2e3):(t.chooseCurrCommunity=t.communityList[0].name,t.chooseCurrCommunityId=t.communityList[0].id,t.loadPark(t.chooseCurrCommunityId))):error_msg(e.code+" 错误 "+e.msg,2e3)},error:function(t){error_msg("网络错误",2e3)}})},loadPark:function(t){var e=this;$.ajax({url:urlDir+"/wx/market/post/inventory",type:"GET",data:{communityId:t,starttime:e.chooseCurrTime},success:function(t){0==t.code?(e.parkList=[],t.data.forEach(function(t,i){e.parkList.push({orderID:t.orderID,communityName:t.communityName,carParkNumber:t.carParkNumber,carParkImg:t.carParkImg,price:t.price,publishFromDates:t.publishFromDates,publishFromTime:t.publishFromTime,publishEndTime:t.publishEndTime})}),e.parkList.length<1&&error_msg("当前没有订单提供",2e3)):error_msg(t.code+" 错误 "+t.msg,2e3)},error:function(t){error_msg("网络错误",2e3)}})},srcollInit:function(){var t=this;setTimeout(function(){var e=(new Date).getFullYear(),i=(new Date).toLocaleDateString();$("#chooseDay").mobiscroll().date({theme:"",lang:"zh",display:"bottom",startYear:e-1,endYear:e+10,headerText:function(t){var e=t.split("/");return e[0]+"年"+e[1]+"月"+e[2]+"日"},onSelect:function(e,o){var r=e.split("/");if(1*i.replace(/\//g,"")>1*r.join(""))return error_msg("日期必须晚于当前",2e3),t.chooseCurrTime=i.replace(/\//g,""),!1;t.chooseCurrTime=r[0]+"-"+r[1]+"-"+r[2],t.loadPark(t.chooseCurrCommunityId)}}),$("#communityList").mobiscroll().treelist({theme:"",lang:"zh",display:"bottom",defaultValue:[communityList[0]],headerText:function(t){},onSelect:function(e,i){t.chooseCurrCommunity=t.communityList[e].name,t.chooseCurrCommunityId=t.communityList[e].id,t.loadPark(t.communityList[e].id)}})},100)},chooseCommunity:function(){this.isBindCommunity?error_msg("当前只能查看用户绑定小区",2e3):$("#communityList_dummy").focus()},getFansInfo:function(){var t=this;$.ajax({url:urlDir+"/wx/fans/get",type:"GET",success:function(e){0==e.code&&(t.phone=e.data.phoneNo)},error:function(t){}})},checkCanPay:function(t){var e=this;if(-1==e.userPosition||4==e.userPosition)e.show("predetermined",t);else switch(e.userPosition){case 1:e.goRouter("/guide_page1"),error_msg("请先绑定电话",2e3);break;case 2:e.goRouter("/guide_page2"),error_msg("请先绑定地址",2e3);break;case 3:e.goRouter("/guide_page3_license_plate"),error_msg("请先成为车主",2e3)}},checkPayFor:function(t){var e=this,i=new Date,o=i.toLocaleDateString()+" "+i.getHours()+":"+i.getMinutes(),r=e.parkList[t].publishFromTime.replace(/-/g,"/");i=new Date(o);var a=new Date(Date.parse(r));i=i.getTime(),a=a.getTime(),e.close("predetermined"),a-i<=36e5?e.show("tip",t):e.checkOrderAndPay(t)},checkOrderAndPay:function(t){var e=this;$.ajax({url:urlDir+"/wx/market/transaction/reservation",type:"POST",data:{orderid:e.parkList[t].orderID,CarNuber:e.parkList[t].CarNuber,type:1},success:function(i){e.close("ceng"),0==i.code?(e.resultFlag=!0,e.show("result",t)):3310==i.code?e.show("depositNotEnough",t):3320==i.code?e.show("balanceNotEnough",t):3400==i.code?e.show("timeConflict",t):3410==i.code?(e.resultFlag=!1,e.show("result",t)):(e.close("ceng"),error_msg(i.code+" 错误 "+i.msg,2e3))},error:function(t){error_msg("网络错误",2e3),e.close("ceng")}})},payForPark:function(t){var e=this;$.ajax({url:urlDir+"/wx/market/transaction/reservation",type:"POST",data:{orderid:e.parkList[t].orderID,CarNuber:e.parkList[t].CarNuber,type:2},success:function(i){e.close("ceng"),0==i.code?(e.resultFlag=!0,e.show("result",t)):3310==i.code?e.show("depositNotEnough",t):3320==i.code?e.show("balanceNotEnough",t):3410==i.code?(e.resultFlag=!1,e.show("result",t)):(e.close("ceng"),error_msg(i.code+" 错误 "+i.msg,2e3)),e.show("result",t)},error:function(t){error_msg("网络错误",2e3),e.close("ceng")}})},show:function(t,e){this.parkChooseIndex=1*e,$("."+t).css("display","block")},close:function(t){$("."+t).css("display","none")},goRouter:function(t){this.$router.push({path:t})},emptyClick:function(t){t.preventDefault(),t.stopPropagation()}}}},125:function(t,e,i){e=t.exports=i(11)(!1),e.push([t.i,".park[data-v-2c5dc185]{max-width:7.5rem;height:100%;overflow:hidden;background-color:#ececec}.choose[data-v-2c5dc185]{background-color:#3c3b3d;width:100%;height:2.2rem;border-bottom-right-radius:1em;border-bottom-left-radius:1em}.choose div[data-v-2c5dc185]{width:100%;height:1.1rem}.choose div img[data-v-2c5dc185]{width:.5rem;height:.5rem;margin:10px 5px}.choose div p[data-v-2c5dc185]{height:20px;line-height:20px;margin-top:.3rem}.choose div span[data-v-2c5dc185]{width:50%;line-height:1.1rem;text-align:right;overflow:hidden}.choose div span img[data-v-2c5dc185]{width:.5rem;height:.5rem;margin:10px 5px}.about[data-v-2c5dc185]{width:100%;height:1.25rem;padding:0 15px}.about img[data-v-2c5dc185]{width:100%;height:1.25rem;margin-top:.05rem}.scroll[data-v-2c5dc185]{width:100%;height:280px;overflow-y:auto;padding-left:15px;padding-right:15px}.order[data-v-2c5dc185]{width:100%;height:2.5rem;border-radius:7px;margin-top:8px;padding-left:15px;padding-right:15px;background-color:#fff}.orderMsg[data-v-2c5dc185]{width:100%;height:1.6rem}.orderMsg div[data-v-2c5dc185]{height:1.6rem}.orderMsg .divMsg[data-v-2c5dc185]{width:100%;height:1.6rem;padding-top:5px;padding-bottom:5px}.orderMsg div p[data-v-2c5dc185]{width:100%;height:.65rem;line-height:.65rem}.orderMsg div img[data-v-2c5dc185]{width:100%;height:100%}.orderPay[data-v-2c5dc185]{clear:both;width:100%;height:.9rem;border-top:1px solid #a0a0a0}.orderPay .btn[data-v-2c5dc185]{width:60%;height:.9rem;padding-top:.18rem;padding-bottom:.2rem}.orderPay .btn div[data-v-2c5dc185]{width:70%;height:100%;background:#3c3b3d;border-radius:5px;text-align:center;line-height:.52rem}.orderPay .icon[data-v-2c5dc185]{width:40%;height:.9rem}.orderPay .icon img[data-v-2c5dc185]{width:100%;height:.9rem}.ceng[data-v-2c5dc185]{width:100%;height:100%;position:absolute;top:0;left:0;background:hsla(0,0%,100%,.75)}.ceng .ceng_content[data-v-2c5dc185]{width:5rem;height:3.9rem;background:#fff;border-radius:.24rem;padding:.3rem .46rem;margin:4.6rem auto;vertical-align:middle;box-shadow:0 0 1rem 0 #c9c9c9;border:1px solid #cfebf8;text-align:center}.ceng .ceng_content img[data-v-2c5dc185]{width:100%;height:2rem}.ceng .ceng_content p[data-v-2c5dc185]{width:100%;height:.5rem;margin:.15rem 0;line-height:.5rem}.ceng .ceng_content input[data-v-2c5dc185]{width:60%;height:.5rem;background:#75859f;border-radius:.12rem;margin-left:.1rem;margin-right:.1rem;color:#fff}.dialog_content[data-v-2c5dc185]{width:60%;height:2.6rem;margin:0 auto;margin-top:4.5rem;padding-top:.3rem;padding-left:.15rem;padding-right:.15rem;border-radius:.3rem;text-align:center;background-color:#fff;box-shadow:0 0 1rem 0 #c9c9c9}.dialog_content p[data-v-2c5dc185]{text-align:center}.dialog_content div[data-v-2c5dc185]{width:100%;height:50%;margin-top:.2rem;line-height:1.25rem;text-align:center}.dele_btn[data-v-2c5dc185]{display:inline-block;color:#fff;height:.54rem;text-align:center;width:1.6rem;line-height:.54rem;background-color:skyblue;border-radius:.1rem;margin:0 .2rem}.ceng .dialog[data-v-2c5dc185]{height:2.2rem;width:70%;position:absolute;top:50%;left:50%;margin-left:-35%;margin-top:-1.7rem;padding-top:.1rem;padding-bottom:.1rem;background-color:#fff;border-radius:.2rem;box-shadow:0 0 1rem 0 #c9c9c9;border:1px solid #cbcbcd}.ceng .dialog .conflict_content img[data-v-2c5dc185]{width:.85rem;height:.85rem;margin-left:2.5%;margin-right:.05rem}.ceng .dialog .conflict_content p[data-v-2c5dc185]{margin-top:.2rem;width:95%;height:1rem}.ceng .dialog .conflict_content div[data-v-2c5dc185]{width:100%;height:.8rem;text-align:center;padding-top:.15rem;padding-bottom:.15rem}.ceng .dialog .conflict_content div input[data-v-2c5dc185]{width:30%;height:.5rem;margin-left:.2rem;margin-right:.2rem;border-radius:.1rem;background-color:#f1f3f1}.ceng .dialog .balanceNotEnough_content img[data-v-2c5dc185]{width:.85rem;height:.85rem;margin-left:2.5%;margin-right:.15rem}.ceng .dialog .balanceNotEnough_content p[data-v-2c5dc185]{margin-top:.2rem;width:95%;height:1rem;line-height:1rem}.ceng .dialog .balanceNotEnough_content div[data-v-2c5dc185]{width:100%;height:.8rem;text-align:center;padding-top:.15rem;padding-bottom:.15rem}.ceng .dialog .balanceNotEnough_content div input[data-v-2c5dc185]{width:30%;height:.5rem;margin-left:.2rem;margin-right:.2rem;border-radius:.1rem;background-color:#f1f3f1}.ceng .dialog .depositNotEnough_content img[data-v-2c5dc185]{width:.85rem;height:.85rem;margin-left:2.5%;margin-right:.15rem}.ceng .dialog .depositNotEnough_content p[data-v-2c5dc185]{margin-top:.2rem;width:95%;height:1rem;line-height:1rem}.ceng .dialog .depositNotEnough_content div[data-v-2c5dc185]{width:100%;height:.8rem;text-align:center;padding-top:.15rem;padding-bottom:.15rem}.ceng .dialog .depositNotEnough_content div input[data-v-2c5dc185]{width:30%;height:.5rem;margin-left:.2rem;margin-right:.2rem;border-radius:.1rem;background-color:#f1f3f1}",""])},162:function(t,e,i){var o=i(125);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(12)("a7252b34",o,!0)},210:function(t,e,i){t.exports=i.p+"static/img/orderPay.5fae573.png"},215:function(t,e,i){t.exports=i.p+"static/img/position.5a92ab5.png"},220:function(t,e,i){t.exports=i.p+"static/img/time_choose1.5404260.png"},234:function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"park"},[o("div",{staticClass:"choose"},[o("div",[o("img",{staticClass:"l",attrs:{src:i(215)}}),t._v(" "),o("p",{staticClass:"l fcw font38"},[t._v("当前查看小区：")]),t._v(" "),o("span",{staticClass:"r fcw font28",on:{click:t.chooseCommunity}},[t._v(t._s(t.chooseCurrCommunity)),o("img",{staticClass:"r",attrs:{src:i(77)}})])]),t._v(" "),o("div",[o("img",{staticClass:"l",attrs:{src:i(220)}}),t._v(" "),o("p",{staticClass:"l fcw font34"},[t._v("当前日期选择：")]),t._v(" "),o("span",{staticClass:"r fcw font26",attrs:{id:"chooseDay"}},[t._v(t._s(t.chooseCurrTime)),o("img",{staticClass:"r",attrs:{src:i(77)}})])])]),t._v(" "),t._m(0),t._v(" "),o("div",{staticClass:"scroll",style:{height:t.max_height}},t._l(t.parkList,function(e,i){return o("div",{staticClass:"order"},[o("div",{staticClass:"orderMsg"},[o("div",{staticClass:"l divMsg"},[o("p",{staticClass:"font26"},[t._v("车位信息： "+t._s(e.communityName+e.carParkNumber))]),t._v(" "),o("p",{staticClass:"font26"},[t._v("订单时间： "),o("span",{staticClass:"font26"},[t._v(t._s(e.publishFromTime+" -- "+e.publishEndTime))])])])]),t._v(" "),o("div",{staticClass:"orderPay",on:{click:function(e){t.checkCanPay(i)}}},[o("div",{staticClass:"l btn"},[o("div",{staticClass:"fcw font32"},[t._v(t._s(e.price)+"元抢拍")])]),t._v(" "),t._m(1,!0)])])})),t._v(" "),o("div",{staticClass:"ceng predetermined",staticStyle:{display:"none"}},[o("div",{staticClass:"ceng_content"},[o("span",{staticStyle:{"background-color":"#fff","border-radius":".3rem",position:"absolute",top:"0","margin-top":"4.4rem",right:"1.05rem"},on:{click:function(e){t.close("ceng")}}},[o("img",{staticStyle:{width:".6rem",height:".6rem"},attrs:{src:i(61)}})]),t._v(" "),o("img",{attrs:{src:i(51)}}),t._v(" "),o("p",{staticClass:"font28"},[t._v("花费"+t._s(t.parkList[0]?t.parkList[0].price:0)+"元预定这个车位吗？")]),t._v(" "),o("input",{staticClass:"font32",attrs:{type:"button",value:"确认"},on:{click:function(e){t.checkPayFor(t.parkChooseIndex)}}})])]),t._v(" "),o("div",{staticClass:"ceng result",staticStyle:{display:"none"}},[o("div",{staticClass:"ceng_content"},[o("span",{staticStyle:{"background-color":"#fff","border-radius":".3rem",position:"absolute",top:"0","margin-top":"4.4rem",right:"1.05rem"},on:{click:function(e){t.close("ceng")}}},[o("img",{staticStyle:{width:".6rem",height:".6rem"},attrs:{src:i(61)}})]),t._v(" "),o("img",{attrs:{src:i(51)}}),t._v(" "),o("p",{staticClass:"font28"},[t._v(t._s(t.resultFlag?"预定成功":"下手晚了，订单被抢走了"))]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.btnStr,expression:"btnStr"}],staticClass:"font30",attrs:{type:"button"},domProps:{value:t.btnStr},on:{click:function(e){t.close("ceng")},input:function(e){e.target.composing||(t.btnStr=e.target.value)}}})])]),t._v(" "),o("div",{staticClass:"ceng tip",staticStyle:{display:"none"}},[o("div",{staticClass:"dialog_content",on:{click:function(e){t.emptyClick(e)}}},[o("p",{staticClass:"font36"},[t._v("距离订单开始时间小于1小时，继续？")]),t._v(" "),o("div",[o("a",{staticClass:"dele_btn",on:{click:function(e){t.checkOrderAndPay(t.parkChooseIndex)}}},[t._v("确认")]),t._v(" "),o("a",{staticClass:"dele_btn",on:{click:function(e){t.close("ceng")}}},[t._v("取消")])])])]),t._v(" "),o("div",{staticClass:"ceng timeConflict",staticStyle:{display:"none"}},[o("div",{staticClass:"dialog"},[o("div",{staticClass:"conflict_content"},[o("img",{staticClass:"l",attrs:{src:i(56)}}),t._v(" "),o("p",{staticClass:"font32"},[t._v("本次订单与您的其他订单存在时间冲突，确定继续？")]),t._v(" "),o("div",[o("input",{staticStyle:{"background-color":"#3c3b3d",color:"#fff"},attrs:{type:"button",value:"确定"},on:{click:function(e){t.payForPark(t.parkChooseIndex)}}}),t._v(" "),o("input",{attrs:{type:"button",value:"再看看"},on:{click:function(e){t.close("timeConflict")}}})])])])]),t._v(" "),o("div",{staticClass:"ceng balanceNotEnough",staticStyle:{display:"none"}},[o("div",{staticClass:"dialog"},[o("div",{staticClass:"balanceNotEnough_content"},[o("img",{staticClass:"l",attrs:{src:i(56)}}),t._v(" "),o("p",{staticClass:"font32"},[t._v("余额 不足请充值再继续")]),t._v(" "),o("div",[o("input",{staticStyle:{"background-color":"#3c3b3d",color:"#fff"},attrs:{type:"button",value:"去充值"},on:{click:function(e){t.goRouter("/balance")}}}),t._v(" "),o("input",{attrs:{type:"button",value:"忍心拒绝"},on:{click:function(e){t.close("balanceNotEnough")}}})])])])]),t._v(" "),o("div",{staticClass:"ceng depositNotEnough",staticStyle:{display:"none"}},[o("div",{staticClass:"dialog"},[o("div",{staticClass:"depositNotEnough_content"},[o("img",{staticClass:"l",attrs:{src:i(56)}}),t._v(" "),o("p",{staticClass:"font32"},[t._v("押金 不足请充值再继续")]),t._v(" "),o("div",[o("input",{staticStyle:{"background-color":"#3c3b3d",color:"#fff"},attrs:{type:"button",value:"去充值"},on:{click:function(e){t.goRouter("/pledge_manage")}}}),t._v(" "),o("input",{attrs:{type:"button",value:"忍心拒绝"},on:{click:function(e){t.close("depositNotEnough")}}})])])])]),t._v(" "),o("ul",{staticStyle:{display:"none"},attrs:{id:"communityList"}},t._l(t.communityList,function(e){return o("li",[o("div",{attrs:{"data-value":e.name}},[t._v(t._s(e.name))])])}))])},staticRenderFns:[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"about"},[o("img",{attrs:{src:i(51)}})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"l icon"},[o("img",{attrs:{src:i(210)}})])}]}},36:function(t,e,i){function o(t){i(162)}var r=i(3)(i(104),i(234),o,"data-v-2c5dc185",null);t.exports=r.exports},51:function(t,e,i){t.exports=i.p+"static/img/no_park.e528370.png"},56:function(t,e,i){t.exports=i.p+"static/img/error.013f46a.png"},61:function(t,e,i){t.exports=i.p+"static/img/close.2201c72.png"},77:function(t,e,i){t.exports=i.p+"static/img/icon16.284d803.png"}});